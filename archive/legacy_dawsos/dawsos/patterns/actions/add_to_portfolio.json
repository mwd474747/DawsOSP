{
  "id": "add_to_portfolio",
  "name": "Add to Portfolio",
  "description": "Adds a position to the tracked portfolio (Trinity 2.0 capability routing)",
  "category": "actions",
  "triggers": [
    "buy",
    "purchase",
    "add position",
    "portfolio add"
  ],
  "entities": [
    "SYMBOL",
    "QUANTITY",
    "PRICE"
  ],
  "priority": 6,
  "steps": [
    {
      "description": "",
      "action": "execute_through_registry",
      "params": {
        "capability": "can_fetch_fundamentals",
        "context": {
          "symbol": "{SYMBOL}"
        }
      },
      "save_as": "asset_data"
    },
    {
      "action": "execute_through_registry",
      "params": {
        "context": {
          "data": {
            "action": "add_position",
            "symbol": "{SYMBOL}",
            "quantity": "{QUANTITY}",
            "price": "{PRICE}",
            "asset_data": "{asset_data}"
          }
        },
        "capability": "can_summarize_data"
      },
      "save_as": "position"
    },
    {
      "action": "execute_through_registry",
      "params": {
        "agent": "claude",
        "context": {
          "user_input": "Added {SYMBOL} to portfolio: {position}. Current data: {asset_data}"
        }
      },
      "save_as": "confirmation"
    }
  ],
  "response_type": "action",
  "response_template": "{confirmation}",
  "cache_ttl": 0,
  "version": "2.0",
  "last_updated": "2025-10-08",
  "template": "## Portfolio Position Added\n\n**Symbol**: {SYMBOL}\n**Quantity**: {QUANTITY} shares\n**Entry Price**: ${PRICE}\n**Total Value**: ${position.total_value}\n\n**Company Details**:\n\u2022 Sector: {asset_data.sector}\n\u2022 Market Cap: ${asset_data.market_cap}B\n\u2022 PE Ratio: {asset_data.pe_ratio}\n\n{confirmation.response}\n\n*Position tracked in DawsOS Trinity 2.0*"
}