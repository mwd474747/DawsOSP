{
  "id": "owner_earnings",
  "name": "Owner Earnings Calculation",
  "triggers": [
    "owner earnings",
    "calculate owner earnings",
    "buffett earnings",
    "true earnings",
    "cash earnings"
  ],
  "description": "Calculate Buffett's owner earnings metric - true cash available to owners (Trinity 2.0 capability routing)",
  "category": "analysis",
  "priority": 80,
  "input_schema": {
    "required": [
      "symbol"
    ],
    "optional": [
      "years"
    ]
  },
  "steps": [
    {
      "description": "Load Buffett owner earnings formula",
      "action": "execute_through_registry",
      "params": {
        "context": {
          "task": "load_knowledge",
          "knowledge_file": "buffett_checklist.json",
          "section": "Financial Strength",
          "request": "Load Buffett's owner earnings calculation methodology"
        },
        "capability": "can_fetch_stock_quotes"
      },
      "save_as": "step_1"
    },
    {
      "description": "Gather financial data for owner earnings",
      "action": "execute_through_registry",
      "params": {
        "capability": "can_fetch_stock_quotes",
        "context": {
          "task": "financial_data",
          "symbol": "{SYMBOL}"
        }
      },
      "save_as": "step_2"
    },
    {
      "description": "Calculate maintenance CapEx estimate",
      "action": "execute_through_registry",
      "params": {
        "context": {
          "symbol": "{symbol}",
          "metric": "maintenance_capex",
          "data": "{step_2}"
        },
        "capability": "can_fetch_stock_quotes"
      },
      "save_as": "step_3"
    },
    {
      "description": "Calculate owner earnings",
      "action": "execute_through_registry",
      "params": {
        "agent": "claude",
        "context": {
          "task": "calculate_owner_earnings",
          "symbol": "{symbol}",
          "formula": "Net Income + D&A - Maintenance CapEx +/- Working Capital Changes - Stock Compensation",
          "data": "{step_2}",
          "maintenance_capex": "{step_3}",
          "request": "Calculate Buffett's owner earnings for {symbol} using the formula. Show detailed calculation steps and compare to reported net income. Calculate owner earnings yield (OE / Market Cap)."
        }
      },
      "save_as": "step_4"
    },
    {
      "description": "Analyze owner earnings quality",
      "action": "execute_through_registry",
      "params": {
        "context": {
          "symbol": "{symbol}",
          "data": "{step_2}"
        },
        "capability": "can_detect_patterns"
      },
      "save_as": "step_5"
    },
    {
      "description": "Interpret investment implications",
      "action": "execute_through_registry",
      "params": {
        "agent": "claude",
        "context": {
          "task": "interpret_owner_earnings",
          "symbol": "{symbol}",
          "calculation": "{step_4}",
          "quality": "{step_5}",
          "request": "Explain what owner earnings reveals about {symbol}'s true profitability and investment attractiveness. Provide actionable insights for investors."
        }
      },
      "save_as": "step_6"
    }
  ],
  "response_type": "analysis",
  "response_template": "{step_6}",
  "template": "ðŸ’° **Owner Earnings Analysis: {SYMBOL}**\n\nðŸ“Š **Calculation Breakdown**\n```\nNet Income:           ${step_4.net_income}M\n+ D&A:               ${step_4.depreciation}M\n- Maintenance CapEx:  ${step_4.maintenance_capex}M\n+/- Working Capital:  ${step_4.working_capital}M\n- Stock Comp Adj:     ${step_4.stock_comp}M\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nOwner Earnings:       ${step_4.owner_earnings}M\n```\n\nðŸ“ˆ **Key Metrics**\nâ€¢ Owner Earnings Yield: {step_4.owner_yield}%\nâ€¢ vs Net Income: {step_4.oe_vs_ni}%\nâ€¢ 3-Year Growth: {step_4.growth_rate}%\nâ€¢ Market Cap: ${step_2.market_cap}B\n\nâœ… **Quality Assessment**\n{step_5.response}\n\nðŸ’¡ **What This Means for Investors**\n{step_6.response}\n\n---\n\nðŸ“š **Buffett's Owner Earnings Concept**\nOwner earnings represents the true cash that could be extracted from the business by owners each year - a more accurate measure of profitability than reported earnings.\n\n*Owner earnings analysis powered by DawsOS Trinity Architecture*",
  "version": "2.0",
  "last_updated": "2025-10-08",
  "notes": "Converted from legacy action types to Trinity-compliant execute_through_registry pattern",
  "entities": [
    "SYMBOL"
  ]
}