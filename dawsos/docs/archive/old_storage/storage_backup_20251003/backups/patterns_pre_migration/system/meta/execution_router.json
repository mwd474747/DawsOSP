{
  "id": "execution_router",
  "name": "Agent Execution Router",
  "description": "Ensures all agents execute through the proper Trinity adapter/registry path with compliance",
  "steps": [
    {
      "action": "validate_agent",
      "params": {
        "agent": "{agent_name}"
      },
      "save_as": "validation"
    },
    {
      "action": "fix_constructor_args",
      "params": {
        "agent": "{agent_name}",
        "validation": "{validation}"
      },
      "save_as": "fixed"
    },
    {
      "action": "inject_capabilities",
      "params": {
        "agent": "{agent_name}",
        "required": "{capabilities}",
        "context": "{context}"
      },
      "save_as": "enriched_context"
    },
    {
      "action": "execute_through_registry",
      "params": {
        "agent": "{agent_name}",
        "method": "{method}",
        "context": "{enriched_context}"
      },
      "save_as": "raw_result"
    },
    {
      "action": "normalize_response",
      "params": {
        "result": "{raw_result}",
        "agent": "{agent_name}",
        "method": "{method}"
      },
      "save_as": "normalized"
    },
    {
      "action": "store_in_graph",
      "params": {
        "result": "{normalized}",
        "agent": "{agent_name}",
        "context": "{context}"
      },
      "save_as": "node_id"
    }
  ],
  "response_template": {
    "result": "{normalized}",
    "node_id": "{node_id}",
    "agent": "{agent_name}",
    "method": "{method}",
    "compliant": true
  }
}