{
  "id": "fundamental_analysis",
  "name": "Fundamental Analysis",
  "triggers": [
    "analyze fundamentals",
    "fundamental analysis",
    "company analysis",
    "stock fundamentals",
    "evaluate company"
  ],
  "description": "Comprehensive fundamental analysis using Buffett and Dalio frameworks (Trinity 2.0 capability routing)",
  "category": "analysis",
  "priority": 90,
  "input_schema": {
    "required": [
      "symbol"
    ],
    "optional": [
      "framework"
    ]
  },
  "steps": [
    {
      "description": "Load investment frameworks",
      "action": "execute_through_registry",
      "params": {
        "capability": "can_fetch_fundamentals",
        "context": {
          "task": "load_knowledge",
          "knowledge_files": [
            "buffett_checklist.json",
            "dalio_cycles.json"
          ]
        }
      },
      "save_as": "step_1"
    },
    {
      "description": "Gather comprehensive financial data",
      "action": "execute_through_registry",
      "params": {
        "capability": "can_fetch_fundamentals",
        "context": {
          "task": "financial_data",
          "symbol": "{SYMBOL}"
        }
      },
      "save_as": "step_2"
    },
    {
      "description": "Analyze economic moat",
      "action": "execute_through_registry",
      "params": {
        "agent": "pattern_spotter",
        "context": {
          "task": "evaluate_moat",
          "symbol": "{symbol}",
          "framework": "buffett_moat_analysis",
          "data": "{step_2}",
          "request": "Evaluate economic moat for {symbol} using Buffett's framework. Assess brand power, network effects, cost advantages, and switching costs."
        }
      },
      "save_as": "step_3"
    },
    {
      "description": "Calculate key financial metrics",
      "action": "execute_through_registry",
      "params": {
        "capability": "can_fetch_fundamentals",
        "context": {
          "task": "calculate_metrics",
          "symbol": "{SYMBOL}",
          "data": "{step_2}",
          "metrics": [
            "Owner Earnings = Net Income + D&A - Maintenance CapEx",
            "ROIC = NOPAT / Invested Capital",
            "FCF Yield = FCF / Market Cap",
            "ROIC-WACC Spread"
          ]
        }
      },
      "save_as": "step_4"
    },
    {
      "description": "Estimate intrinsic value",
      "action": "execute_through_registry",
      "params": {
        "agent": "claude",
        "context": {
          "task": "calculate_intrinsic_value",
          "symbol": "{symbol}",
          "method": "dcf_simplified",
          "data": "{step_2}",
          "metrics": "{step_4}",
          "request": "Calculate intrinsic value for {symbol} using simplified DCF. Estimate margin of safety vs current price."
        }
      },
      "save_as": "step_5"
    },
    {
      "description": "Assess management quality",
      "action": "execute_through_registry",
      "params": {
        "agent": "claude",
        "context": {
          "task": "evaluate_management",
          "symbol": "{symbol}",
          "criteria": [
            "Capital allocation discipline",
            "Shareholder orientation",
            "Transparency and candor"
          ],
          "request": "Evaluate management quality for {symbol} using Buffett's criteria"
        }
      },
      "save_as": "step_6"
    },
    {
      "description": "Synthesize fundamental analysis",
      "action": "execute_through_registry",
      "params": {
        "agent": "claude",
        "context": {
          "task": "synthesize_fundamental_analysis",
          "symbol": "{symbol}",
          "frameworks": "{step_1}",
          "financial_data": "{step_2}",
          "moat_analysis": "{step_3}",
          "key_metrics": "{step_4}",
          "valuation": "{step_5}",
          "management": "{step_6}",
          "request": "Synthesize complete fundamental analysis for {symbol}. Provide clear BUY/HOLD/AVOID recommendation with conviction level and key risks."
        }
      },
      "save_as": "step_7"
    }
  ],
  "template": "\ud83d\udcca **Fundamental Analysis: {SYMBOL}**\n\n{step_7.response}\n\n---\n\n\ud83c\udff0 **Economic Moat Assessment**\n{step_3.response}\n\n\ud83d\udcb0 **Key Financial Metrics**\n\u2022 Owner Earnings: ${step_4.owner_earnings}M\n\u2022 ROIC: {step_4.roic}%\n\u2022 ROIC-WACC Spread: {step_4.roic_spread}%\n\u2022 FCF Yield: {step_4.fcf_yield}%\n\n\ud83d\udcc8 **Valuation**\n\u2022 Intrinsic Value: ${step_5.intrinsic_value}\n\u2022 Current Price: ${step_2.current_price}\n\u2022 Margin of Safety: {step_5.margin_of_safety}%\n\u2022 Recommendation: **{step_7.recommendation}**\n\n\ud83d\udc54 **Management Quality**\n{step_6.response}\n\n\ud83c\udfaf **Investment Decision**\n{step_7.investment_thesis}\n\n\u26a0\ufe0f **Key Risks**\n{step_7.risks}\n\n*Fundamental analysis powered by DawsOS Trinity Architecture using Buffett and Dalio frameworks*",
  "version": "2.0",
  "last_updated": "2025-10-08",
  "notes": "Converted from legacy action types to Trinity-compliant execute_through_registry pattern",
  "entities": [
    "SYMBOL"
  ]
}