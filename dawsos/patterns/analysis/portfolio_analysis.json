{
  "id": "portfolio_analysis",
  "name": "Portfolio Analysis",
  "description": "Analyzes portfolio composition, risk, and performance (Trinity 2.0 capability routing)",
  "category": "analysis",
  "triggers": [
    "portfolio",
    "holdings",
    "allocation",
    "diversification",
    "portfolio risk"
  ],
  "entities": [],
  "priority": 8,
  "steps": [
    {
      "action": "execute_through_registry",
      "params": {
        "context": {
          "request": "Get portfolio holdings from knowledge graph"
        },
        "capability": "can_fetch_stock_quotes"
      },
      "save_as": "holdings"
    },
    {
      "description": "",
      "action": "execute_through_registry",
      "params": {
        "capability": "can_fetch_fundamentals",
        "context": {}
      },
      "save_as": "portfolio_data"
    },
    {
      "action": "execute_through_registry",
      "params": {
        "context": {
          "data": "{portfolio_data}",
          "analysis_type": "portfolio_risk"
        },
        "capability": "can_detect_patterns"
      },
      "save_as": "risk_metrics"
    },
    {
      "action": "execute_through_registry",
      "params": {
        "agent": "claude",
        "context": {
          "user_input": "Analyze portfolio with {holdings} and metrics {risk_metrics}. Provide: 1) Asset allocation 2) Risk assessment 3) Diversification score 4) Performance attribution 5) Rebalancing suggestions"
        }
      },
      "save_as": "portfolio_report"
    }
  ],
  "template": "üìä **Portfolio Analysis**\n\n{portfolio_report.response}\n\n---\n\nüìà **Asset Allocation**\n{portfolio_report.allocation}\n\n‚ö†Ô∏è **Risk Assessment**\n‚Ä¢ Portfolio Beta: {risk_metrics.beta}\n‚Ä¢ Volatility: {risk_metrics.volatility}%\n‚Ä¢ Sharpe Ratio: {risk_metrics.sharpe}\n‚Ä¢ Max Drawdown: {risk_metrics.drawdown}%\n\nüéØ **Diversification Score**: {portfolio_report.diversification}/10\n\nüìä **Performance Attribution**\n{portfolio_report.attribution}\n\nüîÑ **Rebalancing Suggestions**\n{portfolio_report.rebalancing}\n\nüí° **Top Holdings**\n{holdings.top_holdings}\n\n*Portfolio analysis powered by DawsOS Trinity Architecture*",
  "response_type": "analysis",
  "response_template": "{portfolio_report}",
  "cache_ttl": 600,
  "version": "2.0",
  "last_updated": "2025-10-08"
}